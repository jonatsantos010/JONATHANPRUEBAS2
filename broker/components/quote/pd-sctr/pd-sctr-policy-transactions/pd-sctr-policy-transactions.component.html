<div class="form-group row">
    <div class="col-lg-3">
        <app-nav-menuprod></app-nav-menuprod>
    </div>
    <div class="col-lg-9">
        <div class="container-fluid p-0">
            <div class="header-content mb-3">
                <div class="containt-item">
                    <div class="header-item">
                        <span class="title">{{ title }}</span>
                    </div>
                </div>
                <p class="eps-title">
                    {{ lblProducto }}<span>{{ lblFecha }}</span>
                </p>
            </div>
            <div class="collapse-list" [hidden]="flagEstadoReingresar">
                <div>
                    <input class="collapse-open" type="checkbox" id="contratante" />
                    <label class="collapse-btn title" for="contratante">Datos de Póliza
                        <i class="fa fa-angle-down pull-right" style="position: relative; top: 4px"></i>
                    </label>
                    <div class="collapse-panel">
                        <div class="collapse-inner collapse-border">
                            <div class="row">
                                <input
                                    [(ngModel)]="nrocotizacion"
                                    name="nrocotizacion"
                                    type="hidden"/>
                                <div class="col-sm-3" *ngIf="nroSalud != ''">
                                    <span>{{ variable.var_nombre_poliza_1 }}</span>
                                    <input
                                    type="text"
                                    [(ngModel)]="nroSalud"
                                    name="nroSalud"
                                    placeholder="0"
                                    disabled/>
                                </div>
                                <div class="col-sm-3" *ngIf="nroPension != ''">
                                    <span>{{ variable.var_nombre_poliza }}</span>
                                    <input
                                    type="text"
                                    [(ngModel)]="nroPension"
                                    name="nroPension"
                                    placeholder="0"
                                    disabled/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="collapse-list">
                <div>
                    <input class="collapse-open" type="checkbox" id="dcontratante" />
                    <label class="collapse-btn title" for="dcontratante">Datos del Contratante
                        <i class="fa fa-angle-down pull-right" style="position: relative; top: 4px"></i>
                    </label>
                    <div class="collapse-panel">
                        <div class="collapse-inner collapse-border">
                            <div class="row">
                                <div class="col-sm-3">
                                    <span>TIPO DOCUMENTO (*)</span>
                                    <select
                                        disabled
                                        [(ngModel)]="polizaEmitCab.TIPO_DOCUMENTO"
                                        name="TIPO_DOCUMENTO"
                                        class="minimal">
                                        <option [value]="polizaEmitCab.TIPO_DOCUMENTO">
                                            {{ polizaEmitCab.TIPO_DES_DOCUMENTO }}
                                        </option>
                                    </select>
                                </div>
                                <div class="col-sm-3">
                                    <span>NRO DE DOCUMENTO (*)</span>
                                    <input
                                    type="text"
                                    [(ngModel)]="polizaEmitCab.NUM_DOCUMENTO"
                                    name="NUM_DOCUMENTO"
                                    placeholder="Nro De Documento"
                                    disabled/>
                                </div>
                                <div
                                    class="col-sm-3"
                                    [hidden]="perfil == perfilActual"
                                    *ngIf="creditHistory != null && !this.variable.var_isBroker">
                                    <span>TIPO RIESGO</span>
                                    <input
                                    type="text"
                                    [(ngModel)]="creditHistory.sdescript"
                                    name="sdescript"
                                    [ngClass]="creditHistory.nflag == 0 ? 'riesgo-alto' : 'riesgo-bajo'"
                                    disabled/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-9">
                                    <span>NOMBRES Y APELLIDOS / RAZÓN SOCIAL</span>
                                    <input
                                    type="text"
                                    [(ngModel)]="polizaEmitCab.NOMBRE_RAZON"
                                    name="NOMBRE_RAZON"
                                    placeholder="Nombres"
                                    disabled/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <span>DIRECCIÓN</span>
                                    <input
                                    type="text"
                                    [(ngModel)]="polizaEmitCab.DIRECCION"
                                    name="DIRECCION"
                                    placeholder="Dirección"
                                    disabled/>
                                </div>
                                <div class="col-sm-3">
                                <span>CORREO ELECTRÓNICO<label *ngIf="template.ins_email" style="margin: 0"></label></span>
                                <input
                                type="text"
                                [(ngModel)]="polizaEmitCab.CORREO"
                                name="CORREO"
                                placeholder="Correo Electrónico"
                                [disabled]="!flagEmail"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Agregar Contacto -->
        <div
          class="collapse-list"
          *ngIf="contractingdata != null && flagContact && template.ins_addContact">
            <div>
                <input class="collapse-open" type="checkbox" id="contactos" />
                <label class="collapse-btn title" for="contactos">Datos de contacto del cliente
                    <i class="fa fa-angle-down pull-right" style="position: relative; top: 4px"></i>
                </label>
                <div class="collapse-panel">
                    <div class="collapse-inner collapse-border">
                        <div class="row">
                            <div class="col-sm-12 mt-15">
                                <button
                                    *ngIf="contactList.length == 0"
                                    class="pull-right"
                                    (click)="openModal('add-contact')"
                                    style="margin: 0">
                                    <span>Agregar Contacto</span>
                                </button>
                                <table
                                    class="table table-borderless riesgo tblbroker"
                                    style="margin-top: 60px">
                                    <thead>
                                        <tr class="d-flex">
                                            <td class="col-sm text-center">N°</td>
                                            <td class="col-sm text-center">Parentesco</td>
                                            <td class="col-sm text-center">Nombres y Apellidos</td>
                                            <td class="col-sm text-center">Teléfono</td>
                                            <td class="col-sm text-center">Correo Electrónico</td>
                                            <td class="col-sm text-center">Acciones</td>
                                        </tr>
                                    </thead>
                                    <tbody *ngFor="let contacto of contactList; let row = index">
                                        <tr class="d-flex">
                                            <td class="col-sm text-center">{{ row + 1 }}</td>
                                            <td class="col-sm text-center">
                                                {{ contacto.P_DESTICONTACTO }}
                                            </td>
                                            <td class="col-sm text-center">
                                                {{ contacto.P_SNOMBRES }}
                                                {{ contacto.P_SAPEPAT }}
                                                {{ contacto.P_SAPEMAT }}
                                            </td>
                                            <td class="col-sm text-center">
                                                {{ contacto.P_SPHONE }}
                                            </td>
                                            <td class="col-sm text-center">
                                                {{ contacto.P_SE_MAIL }}
                                            </td>
                                            <td class="col-sm text-center">
                                                <img
                                                *ngIf="contacto.P_CLASS == ''"
                                                src="assets/icons/editar.png"
                                                (click)="editContact(contacto.P_NROW)"
                                                title="Editar"
                                                alt="Editar"
                                                />
                                                &nbsp;
                                                <img
                                                *ngIf="contacto.P_CLASS == ''"
                                                src="assets/icons/anular.png"
                                                (click)="deleteContact(row)"
                                                title="Eliminar"
                                                alt="Eliminar"
                                                />
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tbody *ngIf="contactList.length == 0">
                                        <tr class="d-flex">
                                            <td class="col-sm text-center">No tiene Contactos</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Fin Agregar Contacto -->
        <div class="collapse-list">
          <div>
            <input class="collapse-open" type="checkbox" id="comercializador" />
            <label class="collapse-btn title" for="comercializador">
                Datos Brokers
              <i class="fa fa-angle-down pull-right" style="position: relative; top: 4px">
              </i>
            </label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div class="row">
                  <div class="col-sm-12">
                    <div *ngIf="!editFlag">
                      <div [hidden]="!canAddSecondaryBroker" *ngIf="(mode == 'broker' && polizaEmitComer.length == 0) || (mode != 'broker' && polizaEmitComer.length < 3)">
                        <button class="pull-right" (click)="addBroker($event.preventDefault())" style="margin: 10px 0 20px 0">
                          <span>Agregar</span>
                        </button>
                      </div>
                    </div>
  
                    <table class="table table-borderless riesgo tblbroker" style="margin-top: 10px">
                      <thead>
                        <tr class="d-flex">
                          <th class="col-sm text-center">
                            <label>Tipo Documento</label>
                          </th>
                          <th class="col-sm text-center">
                            <label>Nro Documento</label>
                          </th>
                          <th class="col-sm text-center">
                            <label>Nombres y Apellidos / Razón Social</label>
                          </th>
                          <th class="col-sm text-center" *ngIf="(codProducto == 3 || codProducto == 2) && !isUserOp && nTransac == 4 && !isDeclare && sAbrTran != 'DE'">
                            <label>Oficina de Producción</label>
                          </th>
                          <th class="col-sm text-center" *ngIf="mode == 'broker'">
                            <label>Tipo de intermediario</label>
                          </th>
                          <th class="col-sm text-center" *ngIf="mode == 'broker'">
                            <label>Código SBS</label>
                          </th>
                          <th class="col-sm text-center" *ngIf="saludList?.length > 0 && template.ins_comSalud">
                            <label>{{ variable.var_desComisionSalud }}</label>
                          </th>
                          <th class="col-sm text-center ctasa" *ngIf="saludList?.length > 0 && template.ins_comSaludPro && !editFlag">
                            <label>
                                <input
                                type="checkbox"
                                class="checkbox"
                                [(ngModel)]="comPropuestaSalud"
                                *ngIf="template.ins_comSaludProCheck"
                                [disabled]="editFlag || !canProposeComission || (mode == 'renew' &&  epsItem.NCODE == '3')"
                                (change)="resetearPropuesto(3)"
                                name="comPropuestaSalud"/>
                                <span class="schk">
                                    {{ variable.var_desComisionSaludPro }}
                                </span>
                            </label>
                          </th>
                          <th class="col-sm text-center" *ngIf="pensionList?.length > 0 || (!template.ins_pensionList &&template.ins_comPension)">
                            <label>{{ variable.var_desComisionPension }}</label>
                          </th>
                          <th class="col-sm text-center ctasa" *ngIf="(pensionList?.length > 0 && !editFlag) || (!template.ins_pensionList && template.ins_comPensionPro)">
                            <label>
                                <input
                                type="checkbox"
                                class="checkbox"
                                [(ngModel)]="comPropuestaPension"
                                [disabled]="editFlag || !canProposeComission"
                                *ngIf="template.ins_comPensionProCheck"
                                (change)="resetearPropuesto(4)"
                                name="comPropuestaPension"/>
                                <span class="schk">
                                    {{ variable.var_desComisionPensionPro }}
                                </span>
                            </label>
                          </th>
                          <th *ngIf="!editFlag"><label>Acción</label></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="d-flex" *ngIf="polizaEmitComer.length == 0">
                          <td class="col-sm text-center">No hay brokers</td>
                        </tr>
                        <tr class="d-flex" *ngFor="let comer of polizaEmitComer; let i = index">
                          <td class="col-sm text-center">
                            <span>{{ comer.DES_DOC_COMER }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{ comer.DOC_COMER }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{ comer.COMERCIALIZADOR }}</span>
                          </td>
                          <!-- Dep Broker-->
                          <td class="col-sm text-center" *ngIf="(codProducto == 3 || codProducto == 2) && !isUserOp && nTransac == 4 && !isDeclare && sAbrTran != 'DE'">
                            <ng-select
                              [items]="BrokerDep"
                              bindLabel="SDESCRIPT"
                              [ngClass]="{ 'error-validate': inputsValidate[1] }"
                              bindValue="NLOCAL"
                              [(ngModel)]="selectedDep[i]"
                              class="dep-ng"
                              (click)="clearValidate(1)"
                              [clearable]="true"
                              placeholder="Seleccionar Oficina"
                              dropdownPosition="bottom"
                              notFoundText="No hay resultados"
                            >
                              <ng-template ng-option-tmp let-item="item">
                                <div title="{{ item.SDESCRIPT }}">
                                  {{ item.SDESCRIPT }}
                                </div>
                              </ng-template>
                            </ng-select>
                          </td>
                          <!-- Dep Broker-->
                          <th class="col-sm text-center" *ngIf="mode == 'broker'">
                            <label>{{ comer.TYPE_INTERMEDIARY }}</label>
                          </th>
                          <th class="col-sm text-center" *ngIf="mode == 'broker'">
                            <label>{{ comer.CODE_SBS }}</label>
                          </th>
                          <td class="col-sm text-center" *ngIf="saludList.length > 0 && template.ins_comSalud">
                            <span>{{ comer.COMISION_SALUD_AUT }}</span>
                          </td>
                          <td class="col-sm" *ngIf="saludList.length > 0 && template.ins_comSaludPro && !editFlag">
                            <input
                              type="text"
                              class="text-center"
                              name="comisionProSalud{{ i }}"
                              maxlength="5"
                              [ngClass]="{ 'error-validate': comer.valItemSal }"
                              [disabled]="stateBrokerTasaSalud"
                              placeholder="0"
                              [(ngModel)]="comer.COMISION_SALUD_PRO"
                              (ngModelChange)="comisionPropuesta(comer.COMISION_SALUD_PRO, i, 2)"
                              FloatDirective
                            />
                            <!--<input
                              *ngIf="comer.COMISION_SALUD_AUT == 0"
                              type="text"
                              class="text-center"
                              placeholder="0"
                              disabled
                            />-->
                          </td>
                          <td class="col-sm text-center" *ngIf="pensionList.length > 0 && template.ins_comPension">
                            <span>{{ comer.COMISION_PENSION_AUT }}</span>
                          </td>
                          <td class="col-sm" *ngIf="pensionList.length > 0 && template.ins_comPensionPro && !editFlag">
                            <input
                              type="text"
                              class="text-center"
                              name="comisionProPension{{ i }}"
                              maxlength="5"
                              [ngClass]="{ 'error-validate': comer.valItemPen }"
                              [disabled]="stateBrokerTasaPension"
                              placeholder="0"
                              [(ngModel)]="comer.COMISION_PENSION_PRO"
                              (ngModelChange)="comisionPropuesta(comer.COMISION_PENSION_PRO,i,1)"
                              FloatDirective
                            />
                            <!--<input
                              *ngIf="comer.COMISION_PENSION_AUT == 0"
                              type="text"
                              class="text-center"
                              placeholder="0"
                              disabled
                            />-->
                          </td>
                          <td *ngIf="!editFlag">
                            <span style="padding: 0 12px" *ngIf="comer.eliminarBroker">
                                <img
                                src="assets/icons/anular.png"
                                (click)="deleteBroker(i)"
                                title="Eliminar"
                                alt="Eliminar"/>
                            </span>
                            <span style="padding: 0 12px" *ngIf="!comer.eliminarBroker">
                                ------
                            </span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="collapse-list">
          <div>
            <input class="collapse-open" type="checkbox" id="poliza" />
            <label class="collapse-btn title" for="poliza"
              >Datos de la Póliza
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <ng-container *ngIf="codProducto == 2">
                  <div class="row">
                    <div class="col-sm-3">
                      <span>TIPO RENOVACIÓN</span>
                      <select
                        [ngClass]="{ 'error-validate': flagTipoR }"
                        [(ngModel)]="polizaEmitCab.tipoRenovacion"
                        name="tipoRenovacion"
                        [disabled]="editFlag && !this.enabledFrecPago"
                        (change)="habilitarFechas()"
                        class="minimal"
                      >
                        <ng-container *ngFor="let renovacion of tipoRenovacion">
                            <ng-container *ngIf="!(epsItem.NCODE === '3' && renovacion.COD_TIPO_RENOVACION === 7)">
                                <ng-container *ngIf="!(epsItem.NCODE === '3' && renovacion.COD_TIPO_RENOVACION === 6)">
                                    <option [value]="renovacion.COD_TIPO_RENOVACION">
                                        {{renovacion.DES_TIPO_RENOVACION}}
                                    </option>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                      </select>
                    </div>
                    <div class="col-sm-3">
                      <span>{{ variable.var_nombreFechaD }}</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayor }"
                        #dp="bsDatepicker"
                        (change)="validarTipoRenovacion($event)"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.bsValueIni"
                        [(ngModel)]="polizaEmitCab.bsValueIni"
                        name="bsValueIni"
                        [(minDate)]="polizaEmitCab.bsValueIniMin"
                        [(maxDate)]="polizaEmitCab.bsValueFinMax"
                        value="{{
                          polizaEmitCab.bsValueIni | date: 'dd/MM/yyyy'
                        }}"
                        [disabled]="disabledFecha"
                        readonly
                        #desde
                      />
                    </div>
                    <div class="col-sm-3">
                      <span>{{ variable.var_nombreFechaH }}</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayorFin }"
                        [bsConfig]="bsConfig"
                        #dp="bsDatepicker"
                        bsDatepicker
                        (change)="validarTipoRenovacion($event)"
                        [(bsValue)]="polizaEmitCab.bsValueFin"
                        [(ngModel)]="polizaEmitCab.bsValueFin"
                        name="bsValueFin"
                        [(minDate)]="polizaEmitCab.bsValueFinMin"
                        value="{{
                          polizaEmitCab.bsValueFin | date: 'dd/MM/yyyy'
                        }}"
                        #hasta
                        [disabled]="disabledFechaFin"
                        readonly
                      />
                    </div>
                    <div class="col-sm-3">
                      <span>FRECUENCIA PAGO</span>
                      <select
                        [ngClass]="{ 'error-validate': errorFrecPago }"
                        [disabled]="!this.enabledFrecPago"
                        [(ngModel)]="polizaEmitCab.frecuenciaPago"
                        name="frecuenciaPago"
                        (change)="cambioFecha()"
                        class="minimal"
                      >
                        <option value="0">SELECCIONE</option>
                        <option
                          *ngFor="let frecuencia of frecuenciaPago"
                          [value]="frecuencia.COD_TIPO_FRECUENCIA"
                        >
                          {{ frecuencia.DES_TIPO_FRECUENCIA }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-3">
                      <span>MONEDA</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_MONEDA"
                        name="COD_MONEDA"
                        class="minimal"
                      >
                        <option
                          [value]="polizaEmitCab.COD_MONEDA"
                          disabled
                          selected
                        >
                          {{ polizaEmitCab.DES_MONEDA }}
                        </option>
                      </select>
                    </div>
                    <div *ngIf="template.ins_regula_mes || template.ins_facturacion" class="col-sm-3">
                      <span style="margin: 0">&nbsp;</span>
                      <!--AVS INTERCONEXION SABSA 31/08/2023-->
                      <label *ngIf="canBillMonthly && template.ins_regula_mes && this.valMixSAPSA == 0 && this.valSALUD_SCTR != 2" style="width: 100%; margin-bottom: 0">
                        <input
                          type="checkbox"
                          [disabled]="facVencido || editFlag || !clienteValido"
                          [(ngModel)]="polizaEmit.facturacionVencido"
                          name="facturacionVencido"
                          (ngModelChange)="onFacturacion()"
                          class="checkbox"/>
                          <span class="schk" style="margin-top: 15px; font-size: 13px">REGULA A MES VENCIDO</span>
                      </label>
                      <label *ngIf="!canBillMonthly || !template.ins_regula_mes || !clienteValido" style="width: 100%; margin-bottom: 0">&nbsp;</label>
                      <label *ngIf="canBillInAdvance && template.ins_facturacion" style="width: 100%; margin-bottom: 0">
                        <input
                          type="checkbox"
                          [(ngModel)]="polizaEmit.facturacionAnticipada"
                          name="facturacionAnticipada || editFlag"
                          (ngModelChange)="onFacturacion()"
                          class="checkbox"
                          [disabled]="facAnticipada"/>
                          <span class="schk" style="margin-top: 5px; font-size: 13px">FACTURACIÓN ANTICIPADA</span>
                      </label>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_sede">
                      <span>SEDE</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_TIPO_SEDE"
                        name="COD_TIPO_SEDE"
                        class="minimal"
                      >
                        <option [value]="polizaEmitCab.COD_TIPO_SEDE">
                          {{ polizaEmitCab.DES_TIPO_SEDE }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_mina">
                      <span>&nbsp;</span>
                      <label style="width: 100%; margin-bottom: 0"
                        ><span class="spn-delimiter">{{
                          polizaEmitCab.DELIMITACION
                        }}</span></label
                      >
                      <label style="width: 100%; margin-bottom: 0"
                      *ngIf="epsItem.NCODE == 3">
                      <input
                          type="checkbox"
                          [(ngModel)]="polizaEmitCab.MINA"
                          name="MINA"
                          [checked]="polizaEmitCab.MINA"
                          class="checkbox"
                          disabled
                        /><span class="schk chk-mina"
                          >¿Trabajos en mina?</span
                        ></label
                      >
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-6" *ngIf="template.ins_actRealizar">
                      <span>ACTIVIDAD A REALIZAR</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.ACT_TECNICA"
                        name="ACT_TECNICA"
                        title="{{ polizaEmitCab.DES_ACT_TECNICA }}"
                        class="minimal"
                      >
                        <option disabled value="" selected>Seleccionar</option>
                        <option [value]="polizaEmitCab.ACT_TECNICA">
                          {{ polizaEmitCab.DES_ACT_TECNICA }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-6" *ngIf="template.ins_subActividad">
                      <span>SUB-ACTIVIDADES</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_ACT_ECONOMICA"
                        name="COD_ACT_ECONOMICA"
                        title="{{ polizaEmitCab.DES_ACT_ECONOMICA }}"
                        class="minimal"
                      >
                        <option [value]="polizaEmitCab.COD_ACT_ECONOMICA">
                          {{ polizaEmitCab.DES_ACT_ECONOMICA }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-3" *ngIf="template.ins_departamento">
                      <span>DEPARTAMENTO (*)</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_DEPARTAMENTO"
                        name="COD_DEPARTAMENTO"
                        class="minimal"
                      >
                        <option [value]="polizaEmitCab.COD_DEPARTAMENTO">
                          {{ polizaEmitCab.DES_DEPARTAMENTO }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_provincia">
                      <span>PROVINCIA (*)</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_PROVINCIA"
                        name="COD_PROVINCIA"
                        class="minimal"
                      >
                        <option [value]="polizaEmitCab.COD_PROVINCIA">
                          {{ polizaEmitCab.DES_PROVINCIA }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_distrito">
                      <span>DISTRITO (*)</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_DISTRITO"
                        name="COD_DISTRITO"
                        class="minimal"
                      >
                        <option [value]="polizaEmitCab.COD_DISTRITO">
                          {{ polizaEmitCab.DES_DISTRITO }}
                        </option>
                      </select>
                    </div>
                  </div>
                </ng-container>
  
                <ng-container *ngIf="codProducto == 3 && !flagEstadoReingresar">
                  <div class="row">
                    <div class="col-sm-3">
                      <span>TIPO RENOVACIÓN</span>
                      <select
                        [ngClass]="{ 'error-validate': flagTipoR }"
                        [(ngModel)]="polizaEmitCab.tipoRenovacion"
                        name="tipoRenovacion"
                        [disabled]="
                          mode == 'broker' || (editFlag && !this.enabledFrecPago)
                        "
                        (change)="habilitarFechas()"
                        class="minimal"
                      >
                        <option
                          *ngFor="let renovacion of tipoRenovacion"
                          [value]="renovacion.COD_TIPO_RENOVACION"
                        >
                          {{ renovacion.DES_TIPO_RENOVACION }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3">
                      <span>{{ variable.var_nombreFechaD }}</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayor }"
                        #dp="bsDatepicker"
                        (change)="validarTipoRenovacion($event)"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.bsValueIni"
                        [(ngModel)]="polizaEmitCab.bsValueIni"
                        name="bsValueIni"
                        [(minDate)]="polizaEmitCab.bsValueIniMin"
                        [(maxDate)]="polizaEmitCab.bsValueFinMax"
                        value="{{
                          polizaEmitCab.bsValueIni | date: 'dd/MM/yyyy'
                        }}"
                        [disabled]="disabledFecha"
                        readonly
                        #desde
                      />
                    </div>
                    <div class="col-sm-3">
                      <span>{{ variable.var_nombreFechaH }}</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayorFin }"
                        [bsConfig]="bsConfig"
                        #dp="bsDatepicker"
                        bsDatepicker
                        (change)="validarTipoRenovacion($event)"
                        [(bsValue)]="polizaEmitCab.bsValueFin"
                        [(ngModel)]="polizaEmitCab.bsValueFin"
                        name="bsValueFin"
                        [(minDate)]="polizaEmitCab.bsValueFinMin"
                        value="{{
                          polizaEmitCab.bsValueFin | date: 'dd/MM/yyyy'
                        }}"
                        #hasta
                        [disabled]="disabledFechaFin"
                        readonly
                      />
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-3">
                      <span>FRECUENCIA PAGO</span>
                      <select
                        [ngClass]="{ 'error-validate': errorFrecPago }"
                        [disabled]="
                          mode == 'broker' || (editFlag && !this.enabledFrecPago)
                        "
                        [(ngModel)]="polizaEmitCab.frecuenciaPago"
                        name="frecuenciaPago"
                        (change)="cambioFecha()"
                        class="minimal"
                      >
                        <option value="0">SELECCIONE</option>
                        <option
                          *ngFor="let frecuencia of frecuenciaPago"
                          [value]="frecuencia.COD_TIPO_FRECUENCIA"
                        >
                          {{ frecuencia.DES_TIPO_FRECUENCIA }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_iniVigenciaAseg">
                      <span>INICIO VIGENCIA DE ASEGURADOS</span>
                      <input
                        type="text"
                        #dp="bsDatepicker"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FDateIniAseg"
                        name="FDateIniAseg"
                        #desdeAseg
                        [(ngModel)]="polizaEmitCab.FDateIniAseg"
                        [(minDate)]="this.DateMinFechaIniAseg"
                        [(maxDate)]="this.DateFinFechaIniAseg"
                        [disabled]="
                          disabledFechaAseg "
                        (ngModelChange)="validarExcelAseg()"
                        readonly
                      />
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_finVigenciaAseg">
                      <span>FIN VIGENCIA DE ASEGURADOS</span>
                      <input
                        type="text"
                        [bsConfig]="bsConfig"
                        #dp="bsDatepicker"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FDateFinAseg"
                        [(ngModel)]="polizaEmitCab.FDateFinAseg"
                        name="FDateFinAseg"
                        [(minDate)]="polizaEmitCab.bsValueIniMin"
                        disabled
                        value="{{
                          polizaEmitCab.FDateFinAseg | date: 'dd/MM/yyyy'
                        }}"
                        readonly
                      />
                    </div>
                    <div class="col-sm-3">
                      <span>MONEDA</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_MONEDA"
                        name="COD_MONEDA"
                        class="minimal"
                      >
                        <option
                          [value]="polizaEmitCab.COD_MONEDA"
                          disabled
                          selected
                        >
                          {{ polizaEmitCab.DES_MONEDA }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-3" *ngIf="template.ins_tipoCuenta">
                      <span>TIPO DE CUENTA</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.P_SISCLIENT_GBD"
                        name="P_SISCLIENT_GBD"
                        class="minimal"
                      >
                        <option value="2">PRIVADO</option>
                        <option value="1">GOBIERNO</option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_actRealizar">
                      <span>ACTIVIDAD ECONÓMICA</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.ACT_TECNICA"
                        name="ACT_TECNICA"
                        title="{{ polizaEmitCab.DES_ACT_TECNICA }}"
                        class="minimal"
                      >
                        <option disabled value="" selected>Seleccionar</option>
                        <option [value]="polizaEmitCab.ACT_TECNICA">
                          {{ polizaEmitCab.DES_ACT_TECNICA }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_subActividad">
                      <span>CIIU (*)</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_ACT_ECONOMICA"
                        name="COD_ACT_ECONOMICA"
                        title="{{ polizaEmitCab.DES_ACT_ECONOMICA }}"
                        class="minimal"
                      >
                        <option [value]="polizaEmitCab.COD_ACT_ECONOMICA">
                          {{ polizaEmitCab.DES_ACT_ECONOMICA }}
                        </option>
                      </select>
                    </div>
                    <div
                      class="col-sm-3"
                      *ngIf="mode == 'endosar' && codProducto == '3'"
                    >
                      <span>TIPO DE ENDOSO</span>
                      <select
                        [(ngModel)]="polizaEmitCab.TYPE_ENDOSO"
                        name="TYPE_ENDOSO"
                        (change)="changeTipoEndoso()"
                        title="{{ polizaEmitCab.DES_TYPE_ENDOSO }}"
                        class="minimal"
                      >
                        <option value="">SELECCIONE</option>
                        <option
                          *ngFor="let endoso of tipoEndoso"
                          [value]="endoso.TYPE_ENDOSO"
                        >
                          {{ endoso.DES_TYPE_ENDOSO }}
                        </option>
                      </select>
                    </div>
                    <div
                      class="col-sm-3"
                      *ngIf="mode == 'exclude' && codProducto == '3'"
                    >
                      <span>FECHA DE EXCLUSIÓN</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayor }"
                        #dp="bsDatepicker"
                        (ngModelChange)="validarExcelExclu()"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FechaAnulacion"
                        [(ngModel)]="polizaEmitCab.FechaAnulacion"
                        [(minDate)]="polizaEmitCab.FDateIniAseg"
                        [(maxDate)]="polizaEmitCab.FDateFinAseg"
                        value="{{
                          polizaEmitCab.FechaAnulacion | date: 'dd/MM/yyyy'
                        }}"
                        readonly
                        #anulacion
                      />
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_mina">
                      <span>&nbsp;</span>
                      <label style="width: 100%; margin-bottom: 0"
                        ><span class="spn-delimiter">{{
                          polizaEmitCab.DELIMITACION
                        }}</span></label
                      >
                      <label style="width: 100%; margin-bottom: 0"
                        ><input
                          type="checkbox"
                          [(ngModel)]="polizaEmitCab.MINA"
                          name="MINA"
                          [checked]="polizaEmitCab.MINA"
                          class="checkbox"
                          disabled
                        /><span class="schk chk-mina"
                          >¿Trabajos en mina?</span
                        ></label
                      >
                    </div>
                    <div class="col-sm-3">
                      <span>&nbsp;</span>
                      <small>&nbsp;</small>
                      <label style="width: 100%; margin-bottom: 0">
                        <input
                          type="checkbox"
                          disabled
                          [(ngModel)]="polizaEmitCab.NREM_EXC"
                          class="checkbox"
                        />
                        <span class="schk chk-mina">¿Sin tope de ley?</span>
                      </label>
                    </div>
                    <div class="col-sm-3" *ngIf="flagMatrizCert == true">
                      <span>&nbsp;</span>
                      <small>&nbsp;</small>
                      <label style="width: 100%; margin-bottom: 0">
                        <input
                          type="checkbox"
                          [disabled]="true"
                          [(ngModel)]="flagMatrizCert"
                          class="checkbox"
                        />
                        <span class="schk chk-mina">¿Póliza Matriz?</span>
                      </label>
                    </div>
                    <div class="col-sm-3">
                      <div class="col" *ngIf="flagGobiernoEstado">
                        <span>
                          * SI REQUIERE ENVIAR EL TRÁMITE AL EJECUTIVO COMERCIAL,
                          FAVOR DE ACTIVAR EL INDICADOR</span
                        >
                        <label style="width: 100%; margin-bottom: 0">
                          <input
                            type="checkbox"
                            [(ngModel)]="flagAprob"
                            (change)="aprobacionCliente($event)"
                            [disabled]="flagDisableAprob"
                            class="checkbox"
                          />
                          <span class="schk chk-mina"
                            >APROBACIÓN EJECUTIVO COMERCIAL</span
                          >
                        </label>
                      </div>
                    </div>
                    <div class="col-sm-3" *ngIf="mode == 'broker'">
                      <span>FECHA DE EFECTO</span>
                      <input
                        type="text"
                        #dp="bsDatepicker"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FDateEffectBroker"
                        name="FDateEffectBroker"
                        #desdeAseg
                        [(ngModel)]="polizaEmitCab.FDateEffectBroker"
                        [(minDate)]="this.DateMinFechaIniAseg"
                        [(maxDate)]="this.DateFinFechaIniAseg"
                        readonly
                      />
                    </div>
                  </div>
                </ng-container>
                <ng-container *ngIf="codProducto == 3 && flagEstadoReingresar">
                  <div class="row">
                    <div class="col-sm-3">
                      <span>TIPO RENOVACIÓN</span>
                      <select
                        [ngClass]="{ 'error-validate': flagTipoR }"
                        [(ngModel)]="polizaEmitCab.tipoRenovacion"
                        name="tipoRenovacion"
                        [disabled]="
                          (mode == 'broker' ||
                            (editFlag && !this.enabledFrecPago)) &&
                          !flagEstadoReingresar
                        "
                        (change)="habilitarFechas()"
                        class="minimal"
                      >
                        <option
                          *ngFor="let renovacion of tipoRenovacion"
                          [value]="renovacion.COD_TIPO_RENOVACION"
                        >
                          {{ renovacion.DES_TIPO_RENOVACION }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3">
                      <span>{{ variable.var_nombreFechaD }}</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayor }"
                        #dp="bsDatepicker"
                        (ngModelChange)="validarTipoRenovacion($event)"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.bsValueIni"
                        [(ngModel)]="polizaEmitCab.bsValueIni"
                        name="bsValueIni"
                        [(minDate)]="polizaEmitCab.bsValueIniMin"
                        [(maxDate)]="polizaEmitCab.bsValueFinMax"
                        value="{{
                          polizaEmitCab.bsValueIni | date: 'dd/MM/yyyy'
                        }}"
                        [disabled]="disabledFecha && !flagEstadoReingresar"
                        readonly
                        #desde
                      />
                    </div>
                    <div class="col-sm-3">
                      <span>{{ variable.var_nombreFechaH }}</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayorFin }"
                        [bsConfig]="bsConfig"
                        #dp="bsDatepicker"
                        bsDatepicker
                        (change)="validarTipoRenovacion($event)"
                        [(bsValue)]="polizaEmitCab.bsValueFin"
                        [(ngModel)]="polizaEmitCab.bsValueFin"
                        name="bsValueFin"
                        [(minDate)]="polizaEmitCab.bsValueFinMin"
                        value="{{
                          polizaEmitCab.bsValueFin | date: 'dd/MM/yyyy'
                        }}"
                        #hasta
                        [disabled]="disabledFechaFin"
                        readonly
                      />
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-3">
                      <span>FRECUENCIA PAGO</span>
                      <select
                        [ngClass]="{ 'error-validate': errorFrecPago }"
                        [disabled]="
                          (mode == 'broker' ||
                            (editFlag && !this.enabledFrecPago)) &&
                          !flagEstadoReingresar
                        "
                        [(ngModel)]="polizaEmitCab.frecuenciaPago"
                        name="frecuenciaPago"
                        (change)="cambioFecha()"
                        class="minimal"
                      >
                        <option value="0">SELECCIONE</option>
                        <option
                          *ngFor="let frecuencia of frecuenciaPago"
                          [value]="frecuencia.COD_TIPO_FRECUENCIA"
                        >
                          {{ frecuencia.DES_TIPO_FRECUENCIA }}
                        </option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_iniVigenciaAseg">
                      <span>INICIO VIGENCIA DE ASEGURADOS</span>
                      <input
                        type="text"
                        #dp="bsDatepicker"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FDateIniAseg"
                        name="FDateIniAseg"
                        #desdeAseg
                        [(ngModel)]="polizaEmitCab.FDateIniAseg"
                        [(minDate)]="this.DateMinFechaIniAseg"
                        [(maxDate)]="this.DateFinFechaIniAseg"
                        [disabled]="
                          disabledFechaAseg ||
                          (mode == 'endosar' && polizaEmitCab.TYPE_ENDOSO != 2)
                        "
                        (ngModelChange)="validarExcelAseg()"
                        readonly
                      />
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_finVigenciaAseg">
                      <span>FIN VIGENCIA DE ASEGURADOS</span>
                      <input
                        type="text"
                        [bsConfig]="bsConfig"
                        #dp="bsDatepicker"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FDateFinAseg"
                        [(ngModel)]="polizaEmitCab.FDateFinAseg"
                        name="FDateFinAseg"
                        [(minDate)]="polizaEmitCab.bsValueIniMin"
                        disabled
                        value="{{
                          polizaEmitCab.FDateFinAseg | date: 'dd/MM/yyyy'
                        }}"
                        readonly
                      />
                    </div>
                    <div class="col-sm-3">
                      <span>MONEDA</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.COD_MONEDA"
                        name="COD_MONEDA"
                        class="minimal"
                      >
                        <option
                          [value]="polizaEmitCab.COD_MONEDA"
                          disabled
                          selected
                        >
                          {{ polizaEmitCab.DES_MONEDA }}
                        </option>
                      </select>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-sm-3" *ngIf="template.ins_tipoCuenta">
                      <span>TIPO DE CUENTA</span>
                      <select
                        disabled
                        [(ngModel)]="polizaEmitCab.P_SISCLIENT_GBD"
                        name="P_SISCLIENT_GBD"
                        class="minimal"
                      >
                        <option value="2">PRIVADO</option>
                        <option value="1">GOBIERNO</option>
                      </select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_actRealizar">
                      <span class="mb-1">ACTIVIDAD ECONÓMICA (*)</span>
                      <ng-select
                        [disabled]="!flagEstadoReingresar"
                        [items]="technicalList"
                        (change)="onSelectTechnicalActivity($event)"
                        (click)="clearValidate(12)"
                        bindLabel="Name"
                        [ngClass]="{ 'error-validate': inputsValidate[12] }"
                        bindValue="Id"
                        class="border-ng"
                        [(ngModel)]="polizaEmitCab.ACT_TEC_VL"
                        name="ACT_TECNICA"
                        placeholder="Seleccionar"
                        dropdownPosition="bottom"
                        notFoundText="No hay resultados"
                        title="{{ activityMain }}"
                        class="minimal"
                      >
                        <ng-template ng-option-tmp let-item="item">
                          <div title="{{ item.Name }}">{{ item.Name }}</div>
                        </ng-template>
                      </ng-select>
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_subActividad">
                      <span class="mb-1">CIIU (*)</span>
                      <ng-select
                        [items]="economicActivityList"
                        (change)="onSelectEconomicActivity($event)"
                        bindLabel="Name"
                        [ngClass]="{ 'error-validate': inputsValidate[3] }"
                        bindValue="Id"
                        [(ngModel)]="this.polizaEmitCab.ACT_ECO_VL"
                        class="border-ng"
                        (click)="clearValidate(3)"
                        [clearable]="true"
                        [disabled]="!flagEstadoReingresar"
                        placeholder="Seleccionar"
                        dropdownPosition="bottom"
                        notFoundText="No hay resultados"
                        title="{{ subActivity }}"
                      >
                        <ng-template ng-option-tmp let-item="item">
                          <div title="{{ item.Name }}">{{ item.Name }}</div>
                        </ng-template>
                      </ng-select>
                    </div>
                    <div
                      class="col-sm-3"
                      *ngIf="mode == 'endosar' && codProducto == '3'"
                    >
                      <span>TIPO DE ENDOSO</span>
                      <select
                        [(ngModel)]="polizaEmitCab.TYPE_ENDOSO"
                        name="TYPE_ENDOSO"
                        (change)="changeTipoEndoso()"
                        title="{{ polizaEmitCab.DES_TYPE_ENDOSO }}"
                        class="minimal"
                      >
                        <option value="">SELECCIONE</option>
                        <option
                          *ngFor="let endoso of tipoEndoso"
                          [value]="endoso.TYPE_ENDOSO"
                        >
                          {{ endoso.DES_TYPE_ENDOSO }}
                        </option>
                      </select>
                    </div>
                    <div
                      class="col-sm-3"
                      *ngIf="mode == 'exclude' && codProducto == '3'"
                    >
                      <span>FECHA DE EXCLUSIÓN</span>
                      <input
                        type="text"
                        [ngClass]="{ 'error-validate': !flagFechaMenorMayor }"
                        #dp="bsDatepicker"
                        (ngModelChange)="validarExcelExclu()"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FechaAnulacion"
                        [(ngModel)]="polizaEmitCab.FechaAnulacion"
                        [(minDate)]="polizaEmitCab.FDateIniAseg"
                        [(maxDate)]="polizaEmitCab.FDateFinAseg"
                        value="{{
                          polizaEmitCab.FechaAnulacion | date: 'dd/MM/yyyy'
                        }}"
                        readonly
                        #anulacion
                      />
                    </div>
                    <div class="col-sm-3" *ngIf="template.ins_mina">
                      <span>&nbsp;</span>
                      <label style="width: 100%; margin-bottom: 0"
                        ><span class="spn-delimiter">{{
                          polizaEmitCab.DELIMITACION
                        }}</span></label
                      >
                      <label style="width: 100%; margin-bottom: 0"
                        ><input
                          type="checkbox"
                          [(ngModel)]="polizaEmitCab.MINA"
                          name="MINA"
                          [checked]="polizaEmitCab.MINA"
                          class="checkbox"
                          disabled
                        /><span class="schk chk-mina"
                          >¿Trabajos en mina?</span
                        ></label
                      >
                    </div>
                    <div class="col-sm-3">
                      <span>&nbsp;</span>
                      <small>&nbsp;</small>
                      <label style="width: 100%; margin-bottom: 0">
                        <input
                          type="checkbox"
                          (change)="polizaMatriz($event)"
                          [(ngModel)]="polizaEmitCab.NREM_EXC"
                          class="checkbox"
                        />
                        <span class="schk chk-mina">¿Sin tope de ley?</span>
                      </label>
                    </div>
                    <div class="col-sm-3" *ngIf="flagEstadoReingresar == true">
                      <span>&nbsp;</span>
                      <small>&nbsp;</small>
                      <label style="width: 100%; margin-bottom: 0">
                        <input
                          type="checkbox"
                          [disabled]="true"
                          [(ngModel)]="flagIsMatriz"
                          class="checkbox"
                        />
                        <span class="schk chk-mina">¿Póliza Matriz?</span>
                      </label>
                    </div>
  
                    <div class="col-sm-3">
                      <div class="col" *ngIf="flagEstadoReingresar">
                        <span>
                          * SI REQUIERE ENVIAR EL TRÁMITE AL EJECUTIVO COMERCIAL,
                          FAVOR DE ACTIVAR EL INDICADOR</span
                        >
                        <label style="width: 100%; margin-bottom: 0">
                          <input
                            type="checkbox"
                            [(ngModel)]="flagAprob"
                            class="checkbox"
                            (change)="aprobacionCliente($event)"
                          />
                          <span class="schk chk-mina"
                            >APROBACIÓN EJECUTIVO COMERCIAL</span
                          >
                        </label>
                      </div>
                    </div>
                    <div class="col-sm-3" *ngIf="mode == 'broker'">
                      <span>FECHA DE EFECTO</span>
                      <input
                        type="text"
                        #dp="bsDatepicker"
                        [bsConfig]="bsConfig"
                        bsDatepicker
                        [(bsValue)]="polizaEmitCab.FDateEffectBroker"
                        name="FDateEffectBroker"
                        #desdeAseg
                        [(ngModel)]="polizaEmitCab.FDateEffectBroker"
                        [(minDate)]="this.DateMinFechaIniAseg"
                        [(maxDate)]="this.DateFinFechaIniAseg"
                        readonly
                      />
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
        <div
          class="collapse-list"
          *ngIf="
          (codProducto != '3' && mode != 'cancel') ||
          (codProducto == '3' && isUserOp && mode != 'broker') ||
          isComerExclu == 1 ">
        <!-- <div> -->
            <div *ngIf="flagAprovateTecnica != 'renewAprove' ">
            <input class="collapse-open" type="checkbox" id="planilla" />
            <label class="collapse-btn title" for="planilla"
              >Carga de Planilla
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div class="row">
                  <div class="col-sm-3" *ngIf="template.ins_comision">
                    <label class="mb-0"><span>TARIFA (*)</span></label>
                    <select
                      [(ngModel)]="polizaEmitCab.P_COMISION"
                      name="P_COMISION"
                      [ngClass]="{ 'error-validate': camposValidar[1] != '' }"
                      class="minimal"
                      [disabled]="editFlag"
                      id="cboComision"
                    >
                      <option value="">SELECCIONE</option>
                      <option
                        *ngFor="let comision of comisionList"
                        value="{{ comision.idComision }}"
                      >
                        {{ comision.nroComision }}
                      </option>
                    </select>
                  </div>
                  <div
                    [ngClass]="template.ins_comision ? 'col-sm-6' : 'col-sm-9'"
                  >
                    <span>TRAMA (*)</span>
                    <input
                      [ngClass]="{ 'error-validate': errorExcel }"
                      type="file"
                      class="mt-10"
                      #fileInput
                      (change)="seleccionExcel($event.target.files[0])"
                      onclick="this.value=null;"
                      accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                      style="
                        position: relative;
                        top: 8px;
                        margin: 5px 0px;
                        font-size: 16px !important;
                        width: 100%;
                      "
                    />
                    <p *ngIf="alertGrati != ''" class="mb-0 alert-gratificacion">
                      {{ alertGrati }}
                    </p>
                  </div>
                  <div class="col-sm-3">
                    <span>&nbsp;</span>
                    <button
                      type="button"
                      style="display: inline-block; position: relative; top: 5px"
                      (click)="validarExcel()"
                    >
                      <span>Validar</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div>
        <div
          class="collapse-list"
          *ngIf="codProducto == '3' && isComerExclu == 0"
        >
          <div>
            <input class="collapse-open" type="checkbox" id="planilla" />
            <label class="collapse-btn title" for="planilla"
              >Datos de correo de ejecutivo comercial y/o Broker<i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div class="row">
                  <div class="col-md-4">
                    <span>Correo electrónico (*)</span>
                    <input
                      type="text"
                      [(ngModel)]="polizaEmit.SMAIL_EJECCOM"
                      [disabled]="isUserOp || (!this.flagAprob && this.flagGobiernoEstado)"
                      placeholder="Correo electrónico"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12">
                    <span
                      >EL CORREO INGRESADO EN ESTA SECCIÓN, SE CONSIDERARÁ PARA EL
                      ENVÍO DEL TRAMITE A EVALUAR PARA LAS TRANSACCIONES.</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--Gestión de trámite - broker - EHH-->
        <div class="collapse-list" *ngIf="mode == 'broker'">
          <div>
            <input class="collapse-open" type="checkbox" id="carta" />
            <label class="collapse-btn title" for="carta"
              >Carta de Agenciamiento
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div
                  *ngIf="(isUserOp || modificarTransact) && fileCarta.length == 0"
                >
                  <span>ARCHIVO CARTA DE AGENCIAMIENTO (*)</span>
  
                  <div class="row">
                    <div class="col-md-6">
                      <span
                        >Ver Archivos &nbsp;
                        <a
                          (click)="
                            openFilePicker(this.infoTransact.PATHS_FILES_LETTER)
                          "
                          ><img
                            alt="Ver movimientos"
                            src="assets/icons/preview_soat_box.png"
                            title="Ver movimientos"
                            style="cursor: pointer; height: 24px"
                        /></a>
                      </span>
                    </div>
                  </div>
                </div>
                <div *ngIf="!isUserOp">
                  <span>ADJUNTAR ARCHIVO CARTA DE AGENCIAMIENTO (*)</span>
                  <div class="inline-block">
                    <div class="inline-block">
                      <button
                        type="button"
                        (click)="fileInput.click()"
                        style="margin: 10px 0"
                      >
                        <span>Seleccionar Archivo</span>
                      </button>
                      <input
                        hidden
                        #fileInput
                        ngfSelect
                        multiple
                        type="file"
                        [(files)]="fileCarta"
                        [accept]="accept"
                        [maxSize]="maxSize"
                        [(lastInvalids)]="lastInvalids"
                      />
                    </div>
                  </div>
                  <div></div>
                  <div *ngIf="fileCarta.length > 0">
                    <div style="margin-bottom: 0px">
                      <h6>Archivos Seleccionados ({{ fileCarta.length }})</h6>
                      <table class="table">
                        <thead>
                          <tr>
                            <th>Nombre</th>
                            <th class="text-center">Tamaño</th>
                            <th class="text-center">Acción</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let item of fileCarta; let i = index">
                            <td>
                              <strong>{{ item.name }}</strong>
                            </td>
                            <td class="text-center">
                              {{ item.size / 1024 / 1024 | number: ".2" }} MB
                            </td>
                            <td class="text-center">
                              <img
                                src="assets/icons/anular.png"
                                (click)="fileCarta.splice(i, 1)"
                                title="Eliminar"
                                alt="Eliminar"
                              />
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--Exclude VidaLey-->
        <div
          class="collapse-list"
          *ngIf="mode == 'exclude' && codProducto == '3'"
        >
          <div>
            <input class="collapse-open" type="checkbox" id="anulacion" />
            <label class="collapse-btn title" for="anulacion"
              >Datos de exclusión de los asegurados
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div class="row">
                  <div class="col-sm-3">
                    <label><span>TIPO DE DEVOLUCIÓN:</span></label>
                    <label style="margin-left: 5px">Mensual</label>
                  </div>
                  <div class="col-sm-3">
                    <label
                      *ngIf="mode == 'exclude'"
                      style="width: 100%; margin-bottom: 0"
                      ><input
                        type="checkbox"
                        [(ngModel)]="polizaEmitCab.primaCobrada"
                        (ngModelChange)="primaCobradaChange()"
                        name="prima_cobrada"
                        class="checkbox"
                      /><span
                        class="schk"
                        style="margin-top: 15px; font-size: 13px"
                        >¿DEVOLVER A PRIMA COBRADA?</span
                      ></label
                    >
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-3">
                    <span>ESTADO</span>
                    <input
                      type="text"
                      [(ngModel)]="polizaEmitCab.stateReturn"
                      placeholder="Estado"
                      disabled
                    />
                  </div>
                  <div class="col-sm-3">
                    <span>MONTO</span>
                    <input
                      type="text"
                      [(ngModel)]="polizaEmitCab.amountReturn"
                      placeholder="Monto"
                      [disabled]="!flagEmail"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="collapse-list" *ngIf="processID != ''">
          <div>
            <input class="collapse-open" type="checkbox" id="cotizador" />
            <label class="collapse-btn title" for="cotizador">Cotizador
              <i class="fa fa-angle-down pull-right"
                 style="position: relative; top: 4px">
              </i>
            </label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div
                  *ngIf="codProducto == 2"
                  class="row justify-content-between"
                  [hidden]="stateTransac">
                  <div class="col-sm-7">
                    <table
                      class="table table-borderless riesgo"
                      *ngIf="template.ins_mostrarTasas"
                      style="margin: 15px 0">
                      <thead>
                        <tr class="d-flex" style="border-bottom: 1px solid #ddd">
                          <th class="col-sm">
                            <label style="font-weight: 100">{{
                              variable.var_tblTasasTitutoCol1
                            }}</label>
                          </th>
                          <th class="col-sm text-center">
                            <label style="font-weight: 100">{{
                              variable.var_tblTasasTitutoCol2
                            }}</label>
                          </th>
                          <th class="col-sm text-center">
                            <label style="font-weight: 100">{{
                              variable.var_tblTasasTitutoCol5
                            }}</label>
                          </th>
                          <th class="col-sm text-center">
                            <label style="font-weight: 100">{{
                              variable.var_tblTasasTitutoCol3
                            }}</label>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="d-flex" *ngIf="tasasList.length == 0">
                          <td class="col-sm text-center">No hay tasas</td>
                        </tr>
                        <tr
                          class="d-flex"
                          *ngFor="let item of tasasList; let i = index"
                        >
                          <td class="col-sm">
                            <span>{{ item.DES_RIESGO }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{ item.NUM_TRABAJADORES }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{
                              item.MONTO_PLANILLA_SALUD | prettyNumber: 2
                            }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{
                              item.MONTO_PLANILLA_PENSION | prettyNumber: 2
                            }}</span>
                          </td>
                        </tr>
  
                        <!-- <tr class="d-flex" *ngFor="let item of tasasList; let i = index">
                                                      <td class="col-sm"><span>{{item.DES_RIESGO}}</span>
                                                      </td>
                                                      <td class="col-sm text-center">
                                                          <input type="text" placeholder="0"
                                                              [(ngModel)]="item.NUM_TRABAJADORES"
                                                              name="nroTrabajadores{{i}}" disabled />
                                                      </td>
                                                      <td class="col-sm text-center">
                                                          <input type="text" placeholder="0"
                                                              [(ngModel)]="item.MONTO_PLANILLA_SALUD" name="montoPlanilla{{i}}"
                                                              disabled />
                                                      </td>
                                                      <td class="col-sm text-center">
                                                          <input type="text" placeholder="0"
                                                              [(ngModel)]="item.MONTO_PLANILLA_PENSION" name="montoPlanilla{{i}}"
                                                              disabled />
                                                      </td>
                                                  </tr> -->
                      </tbody>
                    </table>
                  </div>
                  <!-- Mejoras -->
                  <div
                    *ngIf="template.ins_rmaList && (pensionList.length > 0 || saludList.length > 0)"
                    class="col-sm-4"
                  >
                    <table
                      class="table table-borderless riesgo"
                      style="margin: 15px 0"
                    >
                      <thead>
                        <tr class="d-flex" style="border-bottom: 1px solid #ddd">
                          <th class="col-sm">
                            <label style="font-weight: 100">RMA</label>
                          </th>
                          <th class="col-sm">
                            <label style="font-weight: 100">VIGENCIA</label>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="d-flex">
                          <td class="col-sm">
                            <span
                              >{{ polizaEmitCab.rma | prettyNumber: 2 }}
                            </span>
                          </td>
                          <td class="col-sm">
                            <span
                              >{{ polizaEmitCab.desdeRma }} -
                              {{ polizaEmitCab.finRma }}
                            </span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <!--Vida ley-->
                <div *ngIf="codProducto == 3" class="row">
                  <div *ngIf="categoryList.length > 0" class="col-sm-9">
                    <table
                      class="table table-borderless riesgo"
                      style="margin: 15px 0"
                    >
                      <thead>
                        <tr class="d-flex" style="border-bottom: 1px solid #ddd">
                          <th class="col-sm">
                            <label style="font-weight: 100">Categoría</label>
                          </th>
                          <th class="col-sm text-center">
                            <label style="font-weight: 100"
                              >Total Trabajadores</label
                            >
                          </th>
                          <th class="col-sm text-center">
                            <label style="font-weight: 100">Monto Planilla</label>
                          </th>
                          <th
                            *ngIf="mode !== 'exclude' && mode !== 'endosar'"
                            class="col-sm text-center"
                          >
                            <label style="font-weight: 100">Tasa</label>
                          </th>
  
                          <th
                            *ngIf="mode !== 'exclude' && mode !== 'endosar'"
                            class="col-sm text-center"
                          >
                            <label style="font-weight: 100"
                              >Tasa Propuesta %</label
                            >
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="d-flex" *ngIf="categoryList.length == 0">
                          <td class="col-sm text-center">No hay tasas</td>
                        </tr>
                        <tr
                          class="d-flex"
                          *ngFor="let item of categoryList; let i = index"
                        >
                          <td class="col-sm">
                            <span>{{ item.SCATEGORIA }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{ item.NCOUNT }}</span>
                          </td>
                          <td class="col-sm text-center">
                            <span>{{
                              item.NTOTAL_PLANILLA | number: "1.2-2"
                            }}</span>
                          </td>
                          <td
                            *ngIf="mode !== 'exclude' && mode !== 'endosar'"
                            class="col-sm text-center"
                          >
                            <span>{{ item.NTASA | prettyNumber: 6 }}%</span>
                          </td>
                          <td
                            class="col-sm text-center"
                            *ngIf="mode !== 'exclude' && mode !== 'endosar'"
                            style="margin-bottom: 5px"
                          >
                            <input
                              style="
                                width: 70% !important;
                                height: 120% !important;
                              "
                              type="text"
                              [disabled]="
                                mode == 'include' ||
                                (mode == 'renew' && isDeclare || flagEstadoCertificado )
                              "
                              class="text-right"
                              [checked]="false"
                              placeholder="0"
                              FloatSixDirective
                              maxlength="12"
                              (blur)="changeRateProposed()"
                              [(ngModel)]="item.ProposalRate"
                              name="ProposalRate-{{ i }}"
                              (keyup.enter)="changeRateProposed()"
                            />
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="col-sm-3" *ngIf="mode !== 'exclude'">
                    <table
                      class="table table-borderless riesgo"
                      [hidden]="rateByPlanList?.length == 0"
                      style="margin: 15px 0"
                    >
                      <thead>
                        <tr class="d-flex" style="border-bottom: 1px solid #ddd">
                          <th class="col-sm-12 text-right">
                            <label style="font-weight: 100">Flat</label>
                          </th>
                        </tr>
                      </thead>
                      <tbody *ngIf="codProducto == 3">
                        <tr class="d-flex" *ngIf="rateByPlanList.length == 0">
                          <td class="col-sm text-center">No hay tasas</td>
                        </tr>
                        <tr
                          class="d-flex"
                          *ngFor="let item of rateByPlanList; let i = index"
                        >
                          <td
                            class="col-sm text-right"
                            *ngIf="item.sactive == true"
                          >
                            <span>{{ item.NTASA }}%</span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <div [hidden]="rateByPlanList.length == 0">
                      <button
                        [hidden]="
                          btnCotiza ||
                          mode == 'include' ||
                          (mode == 'renew' && isDeclare || flagEstadoCertificado)
                        "
                        class="btnCotiza-VL"
                        type="button"
                        (click)="this.validarExcel(99)"
                      >
                        Cotizar Flat</button
                      ><button
                        [hidden]="btnNormal"
                        class="btnCotiza-VL"
                        (click)="this.validarExcel(100)"
                      >
                        Cotizar Normal
                      </button>
                    </div>
                  </div>
                </div>
                <div class="row" [hidden]="stateTransac">
                  <div class="col-sm-12" *ngIf="stateWorker">
                    <p class="msg-error">{{ messageWorker }}</p>
                  </div>
                </div>
                <div
                  class="row"
                  *ngIf="template.ins_saludList || template.ins_categoriaList"
                >
                  <div
                    class="col-sm-6"
                    *ngIf="!stateTransac && saludList.length > 0"
                  >
                    <div class="row">
                      <div class="col-sm-6" *ngIf="template.ins_primaSaludMin">
                        <span>PRIMA MÍNIMA SALUD</span>
                        <input
                          type="text"
                          [(ngModel)]="polizaEmitCab.PRIMA_SALUD_END"
                          name="MIN_SALUD"
                          placeholder="0"
                          disabled
                        />
                      </div>
                      <div
                        class="col-sm-6"
                        *ngIf="
                          mode == 'renew' &&
                          template.ins_primaSaludMinPro &&
                          !editFlag
                        "
                      >
                        <label style="margin: 0"
                          ><span class="schk"
                            ><input
                              type="checkbox"
                              style="top: 3px"
                              class="checkbox"
                              (change)="resetearPropuesto(1)"
                              [(ngModel)]="primMinimaSalud"
                              [disabled]="editFlag || !canProposeComission || (mode == 'renew' &&  epsItem.NCODE == '3')"
                              name="primMinimaSalud"
                            />
                            PRIMA MÍNIMA PROPUESTA</span
                          ></label
                        >
                        <input
                          type="text"
                          placeholder="0"
                          [disabled]="statePrimaSalud"
                          (ngModelChange)="resetearPrimas($event, saludID.id)"
                          maxlength="12"
                          name="MIN_SALUD_PR"
                          [(ngModel)]="polizaEmitCab.MIN_SALUD_PR"
                          FloatDirective
                        />
                      </div>
                    </div>
                    <div class="card mt-3" style="background-color: #EDF6FF;border-color: #5790D3 !important;">
                    <div class="card-body">
                        <div class="row">
                        <div class="col-sm">
                            <h5 style="color: #5790d3;">
                            <img src="assets/images/SCTR_SALUD.png" alt="sctrSALUD" style="width: 36px;"/>
                            SCTR SALUD
                            </h5>
                        </div>
                        </div>
                        <div class="row">
                        <table class="table table-borderless riesgo tblTasas" style="border-collapse: separate;">
                            <thead>
                            <tr class="d-flex">
                                <th class="col-sm text-center">
                                <label>Categoría</label>
                                </th>
                                <th class="col-sm text-center">
                                <label>{{ variable.var_tasaNeta }}</label>
                                </th>
                                <th class="col-sm text-center">
                                <label>Propuesta (%)</label>
                                </th>
                                <th class="col-sm text-center">
                                    <label *ngIf="this.mode == 'exclude'; else elseTransactionSalud">Prima a devolver</label>
                                    <ng-template #elseTransactionSalud>
                                        <label>Prima Mensual</label>
                                    </ng-template>
                                </th>
                            </tr>
                            <hr style="border-color: #cfe3fc !important;"/>
                            </thead>
                            <tbody>
                            <tr class="d-flex" *ngIf="saludList.length == 0">
                                <td class="col-sm text-center">
                                No hay tasas asociadas
                                </td>
                            </tr>
                            <tr
                                class="d-flex"
                                *ngFor="let item of saludList; let i = index"
                            >
                                <td class="col-sm text-center">
                                <span>{{ item.DES_RIESGO }}</span>
                                </td>
                                <td class="col-sm text-center">
                                <span>{{ item.TASA | prettyNumber: 6 }} %</span>
                                </td>
                                <td class="col-sm" style="background-color: #EDF6FF;border-color: #cfe3fc !important;">
                                <input
                                    type="text"
                                    class="text-center"
                                    placeholder="0"
                                    maxlength="5"
                                    name="tasaPropuestaSalud{{ i }}"
                                    [(ngModel)]="item.TASA_PRO"
                                    [ngClass]="{ 'error-validate': item.valItem }"
                                    (ngModelChange)="changeTasaPropuestaSalud($event,item.DES_RIESGO)"
                                    [disabled]="disabledFlat[i].value || (mode == 'renew' &&  epsItem.NCODE == '3')"
                                    FloatSixDirective
                                    style="border-color: #cfe3fc !important;"
                                />
                                <span class="porcentaje">%</span>
                                </td>
                                <td class="col-sm text-center">
                                <span>{{item.AUT_PRIMA | prettyNumber: 2}}</span>
                                </td>
                            </tr>
                            <hr
                                style="margin-bottom: 0"
                                *ngIf="saludList.length > 0"
                                style="border-color: #cfe3fc !important;"/>
                            <tr class="d-flex" *ngIf="saludList.length > 0">
                                <td class="col-sm text-right colspan3">
                                    <span>{{ variable.var_primaNeta }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionSalud">{{this.npremiumnExec_Salud | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionSalud>
                                        <span>{{totalNetoSaludSave | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            <tr class="d-flex" *ngIf="saludList.length > 0">
                                <td class="col-sm text-right colspan3">
                                <span>{{ variable.var_primaComercial }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionSalud">{{this.npremiumnExec_Salud | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionSalud>
                                        <span>{{polizaEmitCab.primaComSalud | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            <tr class="d-flex" *ngIf="saludList.length > 0">
                                <td class="col-sm text-right colspan3">
                                <span>{{ variable.var_igv }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionSalud">{{this.nigvExec_Salud | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionSalud>
                                        <span>{{igvSaludSave | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            <tr class="d-flex" *ngIf="saludList.length > 0">
                                <td class="col-sm text-right colspan3">
                                <span>{{
                                    variable.var_primaComercialTotal
                                }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionSalud">{{this.npremiumExec_Salud | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionSalud>
                                        <span>{{brutaTotalSaludSave | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="col-sm-12">
                            <p class="msg-error">{{ mensajePrimaSalud }}</p>
                        </div>
                        </div>
                    </div>
                    </div>
                  </div>
                  <div
                    [ngClass]="
                      template.ins_pensionWith ? 'col-sm-12' : 'col-sm-6'
                    "
                    *ngIf="
                      (!stateTransac && pensionList.length > 0) ||
                      categoryList.length > 0
                    "
                  >
                    <div class="row">
                      <div
                        [ngClass]="
                          template.ins_pensionWith ? 'col-sm-3' : 'col-sm-6'
                        "
                        *ngIf="template.ins_primaPensionMin && codProducto == '2'"
                      >
                        <span>{{ variable.var_primaMinimaPension }}</span>
                        <input
                          type="text"
                          [(ngModel)]="polizaEmitCab.PRIMA_PEN_END"
                          name="MIN_PENSION"
                          placeholder="Prima Mínima"
                          disabled
                        />
                      </div>
                      <div
                        [ngClass]="
                          template.ins_pensionWith ? 'col-sm-3' : 'col-sm-6'
                        "
                        *ngIf="
                          template.ins_primaPensionMin &&
                          codProducto == '3' &&
                          mode != 'exclude' &&
                          mode != 'endosar'
                        "
                      >
                        <span>{{ variable.var_primaMinimaPension }}</span>
                        <input
                          type="text"
                          [(ngModel)]="polizaEmitCab.PRIMA_PEN_END"
                          name="MIN_PENSION"
                          placeholder="Prima Mínima"
                          disabled
                        />
                      </div>
                      <div
                        [ngClass]="
                          template.ins_pensionWith ? 'col-sm-3' : 'col-sm-6'
                        "
                        *ngIf="
                          mode == 'renew' &&
                          template.ins_primaPensionMinPro &&
                          !editFlag
                        "
                      >
                        <label style="margin: 0"
                          ><span class="schk"
                            ><input
                              type="checkbox"
                              style="top: 3px"
                              class="checkbox"
                              name="primMinimaPension"
                              (change)="resetearPropuesto(2)"
                              [(ngModel)]="primMinimaPension"
                              [disabled]="editFlag || !canProposeComission"
                            />
                            PRIMA MÍNIMA PROPUESTA</span
                          ></label
                        >
                        <input
                          type="text"
                          placeholder="0"
                          style="margin-top: 2px !important"
                          [disabled]="statePrimaPension"
                          maxlength="12"
                          (ngModelChange)="resetearPrimas($event, pensionID.id)"
                          name="MIN_PENSION_PR"
                          [(ngModel)]="polizaEmitCab.MIN_PENSION_PR"
                          FloatDirective
                        />
                      </div>
                      <div *ngIf="template.ins_plan" class="col-sm-3">
                        <label class="mb-0"
                          ><span>{{ variable.var_desPlan }}</span></label
                        >
                        <!--<input type="text" name="desTipoPlan" disabled [(ngModel)]="polizaEmitCab.desTipoPlan" />-->
                        <!-- Ini - marcos silverio -->
                        <select
                          [(ngModel)]="polizaEmitCab.desTipoPlan"
                          class="minimal"
                          [disabled]="
                            this.mode == 'include' ||
                            this.isDeclare ||
                            this.mode == 'exclude' ||
                            this.mode == 'endosar' || flagEstadoCertificado
                          "
                        >
                          <option
                            *ngFor="let p of planList"
                            value="{{ p.SDESCRIPT | uppercase }}"
                          >
                            {{ p.SDESCRIPT }}
                          </option>
                        </select>
                        <!-- Fin - marcos silverio -->
                      </div>
                    </div>
                    <div class="card mt-3" style="background-color: #fff6ed;border-color: #ff9a3b !important;">
                    <div class="card-body">
                        <div class="row">
                        <div class="col-sm">
                            <h5 style="color: #ff9a3b;">
                            <img src="assets/images/SCTR_PENSION.png" alt="sctrPENSION" style="width: 34px;"/>
                            {{ variable.var_nomSubProducto }}
                            </h5>
                        </div>
                        </div>
                        <div class="row" *ngIf="template.ins_pensionList">
                        <table class="table table-borderless riesgo tblTasas" style="border-collapse: separate;">
                            <thead>
                            <tr class="d-flex">
                                <th class="col-sm text-center">
                                <label>Categoría</label>
                                </th>
                                <th class="col-sm text-center">
                                <label>{{ variable.var_tasaNeta }}</label>
                                </th>
                                <th class="col-sm text-center" *ngIf="this.flagAprovateTecnica != 'renewAprove'">
                                <label>Propuesta (%)</label>
                                </th>
                                <th class="col-sm text-center">
                                    <label *ngIf="this.mode == 'exclude'; else elseTransactionPension">Prima a devolver</label>
                                    <ng-template #elseTransactionPension>
                                        <label>Prima Mensual</label>
                                    </ng-template>
                                </th>
                            </tr>
                            <hr style="border-color: #ffead7 !important;"/>
                            </thead>
                            <tbody>
                            <tr class="d-flex" *ngIf="pensionList.length == 0">
                                <td class="col-sm text-center">
                                No hay tasas asociadas
                                </td>
                            </tr>
                            <tr class="d-flex" *ngFor="let item of pensionList; let i = index">
                                <td class="col-sm text-center">
                                <span>{{ item.DES_RIESGO }}</span>
                                </td>
                                <td class="col-sm text-center">
                                <span>{{ item.TASA | prettyNumber: 6 }} %</span>
                                </td>
                                <td class="col-sm" style="border-color: #ffdfc1 !important;" *ngIf="this.flagAprovateTecnica != 'renewAprove'">
                                <input
                                    type="text"
                                    class="text-center"
                                    placeholder="0"
                                    maxlength="5"
                                    name="tasaPropuestaPension{{ i }}"
                                    [(ngModel)]="item.TASA_PRO"
                                    [ngClass]="{ 'error-validate': item.valItem }"
                                    (ngModelChange)="changeTasaPropuestaPension($event,item.DES_RIESGO)"
                                    FloatSixDirective
                                    style="border-color: #ffdfc1 !important;"
                                />
                                <span class="porcentaje">%</span>
                                </td>
                                <td class="col-sm text-center">
                                <span>{{item.AUT_PRIMA | prettyNumber: 2}}</span>
                                </td>
                            </tr>
                            <hr style="margin-bottom: 0" *ngIf="pensionList.length > 0" style="border-color: #ffead7 !important;"/>
                            <tr class="d-flex" *ngIf="pensionList.length > 0">
                                <td class="col-sm text-right colspan3">
                                    <span>{{ variable.var_primaNeta }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionPension">{{this.npremiumnExec_Pension | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionPension>
                                        <span>{{totalNetoPensionSave | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            <tr class="d-flex" *ngIf="pensionList.length > 0">
                                <td class="col-sm text-right colspan3">
                                    <span>{{ variable.var_primaComercial }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionPension">{{this.npremiumnExec_Pension | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionPension>
                                        <span>{{polizaEmitCab.primaComPension | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            <tr class="d-flex" *ngIf="pensionList.length > 0">
                                <td class="col-sm text-right colspan3">
                                    <span>{{ variable.var_igv }}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionPension">{{this.nigvExec_Pension | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionPension>
                                        <span>{{igvPensionSave | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            <tr class="d-flex" *ngIf="pensionList.length > 0">
                                <td class="col-sm text-right colspan3">
                                    <span>{{variable.var_primaComercialTotal}}</span>
                                </td>
                                <td class="col-sm text-center">
                                    <span *ngIf="this.mode == 'exclude'; else elseTransactionPension">{{this.npremiumExec_Pension | prettyNumber: 2}}</span>
                                    <ng-template #elseTransactionPension>
                                        <span>{{brutaTotalPensionSave | prettyNumber: 2}}</span>
                                    </ng-template>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="col-sm-12" *ngIf="this.polizaEmit.facturacionVencido != true">
                            <p class="msg-error">{{ mensajePrimaPension }}</p>
                        </div>
                        </div>
                    </div>
                    </div>
                  </div>
                </div>
                <!-- Tipos de pago -->
                <!-- <div
                  *ngIf="processID != '' && paymentType != null"
                  class="card mt-3 mb-3"
                >
                  <div
                    *ngIf="template.ins_prePaymentEmision"
                    class="col-md-6 card-body"
                  >
                    <label *ngIf="processID != ''" style="width: 100%; margin-bottom: 0">
                      <input
                        type="checkbox"
                        [(ngModel)]="prePayment"
                        (click)="prePaymentChange()"
                        name="prePayment"
                        class="checkbox"/>
                        <span class="schk" style="margin-top: 15px; top: -2px">PAGO ADELANTADO</span>
                    </label>
                    <div class="row mt-3">
                      <div class="col-md-6" *ngIf="prePayment && paymentType.bvisa == 1 && !(this.codProducto == 2)"> 
                        <img
                          src="./assets/soat/img/visa.png"
                          alt="Visa"
                          height="48"
                          *ngIf="!!visaData"
                          appVisaButton
                          [config]="visaData"
                          [amount]="visaData.amount"
                          (myClick)="visaClick()"/>
                      </div>
                      <div class="col-md-6" *ngIf="prePayment && paymentType.bpagoefectivo == 1">
                        <div class="row">
                          <div>
                            <img
                              src="./assets/soat/img/pago-efectivo.png"
                              alt="PagoEfectivo"
                              height="42"
                              (click)="onPayment()"
                              class="cursor"/>
                          </div>
                          <div style="position: relative; top: 9px; left: 7px">
                            <img
                              src="./assets/soat/img/info.png"
                              alt="PagoEfectivo"
                              height="12"
                              (click)="openPagoEfectivoInfo()"
                              class="cursor info"/>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div> -->
  
                <div class="row" *ngIf="mode == 'cancel'">
                  <div class="col-sm-6">
                    <span>MOTIVO DE ANULACIÓN</span>
                    <ng-select
                      [items]="annulmentList"
                      bindLabel="DES_ANULACION"
                      bindValue="COD_ANULACION"
                      [(ngModel)]="annulmentID"
                      class="border-ng"
                      [clearable]="true"
                      placeholder="Seleccionar"
                      dropdownPosition="bottom"
                      name="annulment"
                      notFoundText="No hay resultados"
                    >
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="collapse-list">
          <div>
            <input class="collapse-open" type="checkbox" id="history" />
            <label class="collapse-btn title" for="history">
              Evaluar
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <!--Gestión de trámite EHH-->
                <div *ngIf="transactNumber != 0" class="row">
                  <div
                    *ngIf="
                      modificarTransact == true || reingresarTransact == true;
                      then selectMod;
                      else selectPro
                    "
                  ></div>
                  <ng-template #selectMod>
                    <div class="col-sm-3">
                      <span>ESTADO (*)</span>
                      <select
                        [(ngModel)]="statusTransact"
                        (change)="changeStatusTransactMod($event)"
                        class="minimal"
                      >
                        <option selected value="">Seleccione</option>
                        <option value="2">Aprobado</option>
                        <option value="99">Anular</option>
                      </select>
                    </div>
                  </ng-template>
                  <ng-template #selectPro>
                    <div class="col-sm-3">
                      <span>ESTADO (*)</span>
                      <select
                        [(ngModel)]="statusTransact"
                        (change)="changeStatusTransact($event)"
                        class="minimal"
                      >
                        <option selected value="">Seleccione</option>
                        <option value="2">Aprobado</option>
                        <option value="6">Rechazar</option>
                        <!-- <option value="16">En Pausa</option> -->
                      </select>
                    </div>
                    <div *ngIf="statusTransact == 6" class="col-sm-6">
                      <span>MOTIVO DE RECHAZO (*)</span>
                      <ng-select
                        [items]="rechazoMotivoList"
                        bindLabel="DES_MOTIVO"
                        bindValue="COD_MOTIVO"
                        [(ngModel)]="rechazoMotivoID"
                        class="border-ng"
                        [clearable]="true"
                        placeholder="Seleccionar"
                        dropdownPosition="bottom"
                        name="motivorechazo"
                        notFoundText="No hay resultados"
                      >
                      </ng-select>
                    </div>
                  </ng-template>
                </div>
                <!--Gestión de trámite EHH-->
                <div class="row">
                  <div class="col-sm-12">
                    <span>COMENTARIO</span>
                    <textarea
                      cols="40"
                      rows="5"
                      style="width: 100%"
                      [(ngModel)]="polizaEmit.comentario"
                      name="comentario"
                      (keypress)="textValidate($event, 4)"
                      maxlength="4000"
                    ></textarea>
                  </div>
                </div>
                <div>
                  <div class="inline-block">
                    <div class="inline-block">
                      <button
                        type="button"
                        (click)="fileInput.click()"
                        style="margin: 10px 0"
                      >
                        <span>Seleccionar Archivo</span>
                      </button>
                      <input
                        hidden
                        #fileInput
                        ngfSelect
                        multiple
                        type="file"
                        [(files)]="files"
                        [accept]="accept"
                        [maxSize]="maxSize"
                        [(lastInvalids)]="lastInvalids"
                        (filesChange)="seleccionArchivos()"
                      />
                    </div>
                  </div>
                  <div></div>
                  <div *ngIf="files.length > 0">
                    <div style="margin-bottom: 0px">
                      <h6>Archivos Seleccionados ({{ files.length }})</h6>
                      <table class="table">
                        <thead>
                          <tr>
                            <th>Nombre</th>
                            <th class="text-center">Tamaño</th>
                            <th class="text-center">Acción</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let item of files; let i = index">
                            <td>
                              <strong>{{ item.name }}</strong>
                            </td>
                            <td class="text-center">
                              {{ item.size / 1024 / 1024 | number: ".2" }} MB
                            </td>
                            <td class="text-center">
                              <img
                                src="assets/icons/anular.png"
                                (click)="files.splice(i, 1)"
                                title="Eliminar"
                                alt="Eliminar"
                              />
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          class="collapse-list"
          *ngIf="transactNumber != 0 || existsOldTransact"
        >
          <div>
            <input class="collapse-open" type="checkbox" id="history" />
            <label
              *ngIf="!existsOldTransact"
              class="collapse-btn title"
              for="history"
            >
              Historial de Trámite: {{ this.transactNumber }}
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <label
              *ngIf="existsOldTransact"
              class="collapse-btn title"
              for="history"
            >
              Historial de Trámite anterior: {{ infoTransact.NID_TRAMITE }}
              <i
                class="fa fa-angle-down pull-right"
                style="position: relative; top: 4px"
              ></i
            ></label>
            <div class="collapse-panel">
              <div class="collapse-inner collapse-border">
                <div class="grid form-group">
                  <div class="table-responsive">
                    <table class="table">
                      <thead>
                        <tr class="grid-title">
                          <th
                            *ngIf="codProducto == 3"
                            style="text-align: center"
                            class="grid-title-item"
                          >
                            Número
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Estado
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Usuario asignado
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Perfil
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Asignado por
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Fecha
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Comentario
                          </th>
                          <th style="text-align: center" class="grid-title-item">
                            Archivos
                          </th>
                        </tr>
                      </thead>
                      <tbody
                        *ngIf="
                          statusChangeList == null || statusChangeList.length == 0
                        "
                      >
                        <tr>
                          <td colspan="7">No se encontraron registros.</td>
                        </tr>
                      </tbody>
                      <tbody
                        *ngIf="
                          statusChangeList != null && statusChangeList.length > 0
                        "
                      >
                        <tr *ngFor="let item of listToShow; let i = index">
                          <td *ngIf="codProducto == 3">{{ item.LINEA }}</td>
                          <td>{{ item.DES_ESTADO }}</td>
                          <td>{{ item.USUARIO_ASSIGNED }}</td>
                          <td>{{ item.SPERFIL }}</td>
                          <td>{{ item.USUARIO_ASSIGNOR }}</td>
                          <td>
                            {{ item.DFEC_REG | date: "dd/MM/yyyy, h:mm:ss a" }}
                          </td>
                          <td>{{ item.SCOMMENT }}</td>
  
                          <ng-container
                            *ngIf="
                              item.PATHS_FILES != null &&
                                item.PATHS_FILES.length > 0;
                              then showButton;
                              else hideButton
                            "
                          >
                          </ng-container>
                          <ng-template #showButton>
                            <td>
                              <a (click)="openFilePicker(item.PATHS_FILES)"
                                ><img
                                  alt="Ver movimientos"
                                  src="assets/icons/preview_soat_box.png"
                                  title="Ver movimientos"
                                  style="cursor: pointer; height: 24px"
                              /></a>
                            </td>
                          </ng-template>
                          <ng-template #hideButton>
                            <td>Sin Archivos</td>
                          </ng-template>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div
                  *ngIf="statusChangeList != null && statusChangeList.length > 0"
                  class="row"
                  style="display: flex"
                >
                  <div class="col-sm-12">
                    <ngb-pagination
                      [(page)]="currentPage"
                      [pageSize]="itemsPerPage"
                      [collectionSize]="totalItems"
                      [maxSize]="maxSize"
                      (pageChange)="pageChanged(currentPage)"
                    >
                      <ng-template ngbPaginationPrevious>ANTERIOR</ng-template>
                      <ng-template ngbPaginationNext>SIGUIENTE</ng-template>
                    </ngb-pagination>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="col-sm-12">
            <div style="display: flex; float: right">
              <button
                *ngIf="codProducto == 2"
                type="button"
                routerLink="/extranet/sctr/consulta-polizas"
              >
                <span>CANCELAR</span>
              </button>
              <!-- <button
                *ngIf="codProducto == 3"
                type="button"
                routerLink="/extranet/policy-transactions-all"
              >
                <span>CANCELAR</span> 
              </button>-->
              <!-- <button
                [hidden]="this.flagDisabledRestric"
                (click)="generarPoliza(f)"
                *ngIf="
                  (codProducto != 3 &&
                    !prePayment &&
                    !polizaEmitCab.prePayment) 
                "
                class="full-color"
              >
                <span>PROCESAR</span>
              </button> -->
              <button
                (click)="generarPoliza()"
                class="full-color"
              >
                <span>PROCESAR</span>
              </button>
              <!-- <button
                [hidden]="flagProcesar"
                (click)="DerivarTramite(f)"
                *ngIf="codProducto == 3 && isUserOp"
                class="full-color"
              >
                <span>{{ buttonName }}</span>
              </button> -->
              <!-- <button
                (click)="generarTramite()"
                *ngIf="
                  codProducto == 3 &&
                  !isUserOp &&
                  !anularTramite &&
                  isComerExclu == 0 &&
                  !reingresarTransact
                "
                class="full-color"
              >
                <span>GENERAR TRÁMITE</span>
              </button>
              <button
                (click)="reingresarTramite()"
                *ngIf="
                  codProducto == 3 &&
                  !isUserOp &&
                  !anularTramite &&
                  isComerExclu == 0 &&
                  reingresarTransact
                "
                class="full-color"
              >
                <span>REINGRESAR TRÁMITE</span>
              </button>
              <button
                (click)="AnularTramite()"
                *ngIf="codProducto == 3 && !isUserOp && anularTramite"
                class="full-color"
              >
                <span>ANULAR TRÁMITE</span>
              </button>
              <button
                (click)="ModificarBroker()"
                *ngIf="
                  codProducto == 3 && isUserOp && flagProcesar && mode == 'broker'
                "
                class="full-color"
              >
                <span>MODIFICAR BROKER</span>
              </button>
  
              <button
                (click)="procesarTramaEstado()"
                *ngIf="
                  codProducto == 3 && isUserOp && flagProcesar && mode == 'certificate' && flagEstadoCertificado
                "
                class="full-color"
              >
                <span>PROCESAR</span>
              </button> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <ng-template #peModal>
    <div class="modal-body">
      <img
        src="./assets/soat/img/pago-efectivo-info.png"
        height="250"
        alt="PagoEfectivo"
      />
    </div>
    <div class="modal-footer footer-pe">
      <div class="row align-self-center mx-auto">
        <!-- <div class="col soat-text-align-center"> -->
        <button class="soat-button ripple btn-pe" (click)="modalRef.hide()">
          Cerrar
        </button>
        <!-- </div> -->
      </div>
    </div>
  </ng-template>
  
  <panel-info-pago
    [(abrir)]="modal.pagos"
    [cotizacion]="cotizacion"
    (confirmar)="formaPagoElegido()"
    [(isLoading)]="loading"
  >
  </panel-info-pago>
  
  <!-- Pantalla de carga -->
  <div [hidden]="!loading" class="loadingScreen">
    <div style="display: flex; height: 100%; width: 100%">
      <i style="margin: auto; font-size: 50px" class="fa fa-spinner fa-spin"></i>
    </div>
  </div>
  